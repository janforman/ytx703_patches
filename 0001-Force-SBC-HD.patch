From 5b6a63fdccd55053d4a89bb88b63db70313ab3ab Mon Sep 17 00:00:00 2001
From: Jan Forman <info@janforman.com>
Date: Mon, 6 May 2019 17:40:10 +0000
Subject: [PATCH] Force-SBC-HD

Change-Id: Icff556d525debd0f1cd5a8ec77e60f41fc212fef
---
 stack/a2dp/a2dp_sbc.cc         | 6 +++---
 stack/a2dp/a2dp_sbc_encoder.cc | 2 +-
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/stack/a2dp/a2dp_sbc.cc b/stack/a2dp/a2dp_sbc.cc
index bef5bf9..d40a7d4 100644
--- a/stack/a2dp/a2dp_sbc.cc
+++ b/stack/a2dp/a2dp_sbc.cc
@@ -56,7 +56,7 @@ typedef struct {
 /* SBC Source codec capabilities */
 static const tA2DP_SBC_CIE a2dp_sbc_source_caps = {
     (A2DP_SBC_IE_SAMP_FREQ_44),                         /* samp_freq */
-    (A2DP_SBC_IE_CH_MD_MONO | A2DP_SBC_IE_CH_MD_JOINT), /* ch_mode */
+    (A2DP_SBC_IE_CH_MD_MONO | A2DP_SBC_IE_CH_MD_JOINT | A2DP_SBC_IE_CH_MD_DUAL), /* ch_mode */
     (A2DP_SBC_IE_BLOCKS_16 | A2DP_SBC_IE_BLOCKS_12 | A2DP_SBC_IE_BLOCKS_8 |
      A2DP_SBC_IE_BLOCKS_4),            /* block_len */
     A2DP_SBC_IE_SUBBAND_8,             /* num_subbands */
@@ -977,12 +977,12 @@ static bool select_audio_bits_per_sample(
 static bool select_best_channel_mode(uint8_t ch_mode, tA2DP_SBC_CIE* p_result,
                                      btav_a2dp_codec_config_t* p_codec_config) {
   if (ch_mode & A2DP_SBC_IE_CH_MD_JOINT) {
-    p_result->ch_mode = A2DP_SBC_IE_CH_MD_JOINT;
+    p_result->ch_mode = A2DP_SBC_IE_CH_MD_DUAL;
     p_codec_config->channel_mode = BTAV_A2DP_CODEC_CHANNEL_MODE_STEREO;
     return true;
   }
   if (ch_mode & A2DP_SBC_IE_CH_MD_STEREO) {
-    p_result->ch_mode = A2DP_SBC_IE_CH_MD_STEREO;
+    p_result->ch_mode = A2DP_SBC_IE_CH_MD_DUAL;
     p_codec_config->channel_mode = BTAV_A2DP_CODEC_CHANNEL_MODE_STEREO;
     return true;
   }
diff --git a/stack/a2dp/a2dp_sbc_encoder.cc b/stack/a2dp/a2dp_sbc_encoder.cc
index bd09989..51d2f9d 100644
--- a/stack/a2dp/a2dp_sbc_encoder.cc
+++ b/stack/a2dp/a2dp_sbc_encoder.cc
@@ -39,7 +39,7 @@
 #define A2DP_SBC_ENCODER_INTERVAL_MS 20
 
 /* High quality quality setting @ 44.1 khz */
-#define A2DP_SBC_DEFAULT_BITRATE 328
+#define A2DP_SBC_DEFAULT_BITRATE 492
 
 #define A2DP_SBC_NON_EDR_MAX_RATE 229
 
-- 
2.7.4

